/*!
 * 
 *   hello-bar v1.1.0
 *   https://github.com/AnandChowdhary/hello-bar
 * 
 *   Copyright (c) Anand Chowdhary (https://github.com/AnandChowdhary)
 * 
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *   
 */
!function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define("HelloBar",[],e):"object"===typeof exports?exports.HelloBar=e():t.HelloBar=e()}(window,function(){return function(t){var e={};function __webpack_require__(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,n){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},__webpack_require__.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)__webpack_require__.d(n,i,function(e){return t[e]}.bind(null,i));return n},__webpack_require__.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=2)}([function(t,e){t.exports=function(t,e,i){var r=/#/.test(t),o=void 0!==e&&void 0!==i,s=Array.isArray(t),a="#ffffff",c=0;if(r)c=n(t.substr(1,2)),e=n(t.substr(3,2)),i=n(t.substr(5,2));else if(o)c=parseInt(t),e=parseInt(e),i=parseInt(i);else{if(!s)return a;c=parseInt(t[0]),e=parseInt(t[1]),i=parseInt(t[2])}return Math.sqrt(c*c*.241+e*e*.691+i*i*.068)>130&&(a="#000000"),a};var n=function(t){var e=t.replace(/[^a-f0-9]/gi,"");return parseInt(e,16)}},function(t,e){function debounce(t,e,n){var i,r,o,s,a;function later(){var c=Date.now()-s;c<e&&c>=0?i=setTimeout(later,e-c):(i=null,n||(a=t.apply(o,r),o=r=null))}null==e&&(e=100);var c=function(){o=this,r=arguments,s=Date.now();var c=n&&!i;return i||(i=setTimeout(later,e)),c&&(a=t.apply(o,r),o=r=null),a};return c.clear=function(){i&&(clearTimeout(i),i=null)},c.flush=function(){i&&(a=t.apply(o,r),o=r=null,clearTimeout(i),i=null)},c}debounce.debounce=debounce,t.exports=debounce},function(t,e,n){t.exports=n(4)},function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(3);var i=n(0),r=n.n(i),o=n(1),s=n.n(o),a=["BE","BG","CZ","DK","DE","EE","IE","EL","ES","FR","HR","IT","CY","LV","LT","LU","HU","MT","NL","AT","PL","PT","RO","SI","SK","FI","SE","UK"];function _typeof(t){return(_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var c=function(){function App(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,App),t=t||{},this.settings=t,["i18n","targeting"].forEach(function(t){e.settings[t]=e.settings[t]||{}}),this.settings.targeting.location=this.settings.targeting.location||{},this.settings.targeting.params=this.settings.targeting.params||{},this.settings.targeting.time=this.settings.targeting.time||{},this.settings.targeting.time.before=this.settings.targeting.time.before||{},this.settings.targeting.time.after=this.settings.targeting.time.after||{},this.id="helloBar_"+Math.random().toString(36).substr(2),this.bar=document.createElement("div"),this.bar.setAttribute("id",this.id),"object"===_typeof(this.settings.text)?this.text=this.settings.text[Math.floor(Math.random()*this.settings.text.length)]:this.text=this.settings.text,this.bar.innerHTML='<div class="hello-bar-container"><p class="hello-bar-text">'.concat(this.text,'</p></div><div class="hello-bar-text--after"></div>'),this.settings.hideClose||(this.bar.innerHTML+='<button class="hello-bar-button" aria-controls="'.concat(this.id,'" aria-expanded="true" aria-label="').concat(this.settings.i18n.hideText||"Hide announcement",'">\n        <svg aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512">\n            <path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path>\n        </svg>\n      </button>')),this.bar.classList.add("hello-bar"),this.settings.fixed&&this.bar.classList.add("hello-bar--is-fixed"),"bottom"===this.settings.position?(this.bar.classList.add("hello-bar--is-bottom"),this.marginProp="marginBottom"):this.marginProp="marginTop",this.events={},window.addEventListener("resize",s()(function(){document.querySelector("#".concat(e.id))&&(e.$emit("window-resize"),e.unMove(),e.settings.disableBodyMove||e.moveElements(document.body),e.moveElements(e.settings.move),e.colorizeBar())},200)),this.confirmShow().then(function(){e.$emit("before-created"),e.insertBar(),e.functionBar(),e.calculateHeight(),e.colorizeBar(),e.settings.disableBodyMove||e.moveElements(document.body),e.moveElements(e.settings.move),e.showBar(),e.$emit("after-created")}).catch(function(){e.$emit("not-created")})}var t,e,n;return t=App,(e=[{key:"on",value:function(t,e){this.events[t]=e}},{key:"$emit",value:function(t,e){this.events[t]&&"function"===typeof this.events[t]&&this.events[t](e)}},{key:"confirmShow",value:function(){var t=this;return new Promise(function(e,n){var i=function(){if(t.settings.targeting.once&&sessionStorage.getItem("hello-bar--session-showed"))return n();if(t.settings.targeting.onceUser&&localStorage.getItem("hello-bar--user-showed"))return n();if(Object.keys(t.settings.targeting.time).length){var i={year:"getFullYear",month:"getMonth",day:"getDate",dayOfWeek:"getDay",hour:"getHours",minute:"getMinutes",second:"getSeconds"},r=["getMonth","getDay"];["year","month","day","hour","minute","second"].forEach(function(e){var o=new Date;if(t.settings.targeting.time.after[e]){var s=o[i[e]]();if(r.includes(e)&&(s+=1),s<=t.settings.targeting.time.after[e])return n()}if(t.settings.targeting.time.before[e]){var a=o[i[e]]();if(r.includes(e)&&(a+=1),a>=t.settings.targeting.time.after[e])return n()}})}return t.settings.targeting.params&&Object.keys(t.settings.targeting.params).forEach(function(e){var i=function(t){var e=window.location.href;t=t.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(n&&n[2])return decodeURIComponent(n[2].replace(/\+/g," "))}(e);if(i&&i!==t.settings.targeting.params[e])return n()}),t.settings.targeting.pathname&&window.location.pathname!==t.settings.targeting.pathname?n():t.settings.targeting.href&&window.location.href!==t.settings.targeting.href?n():void e()};if(t.settings.hide)return n();Object.keys(t.settings.targeting.location).length?t.getIpInfo().then(function(e){if(t.settings.targeting.location.eu&&!a.includes(e.country))return n();["country","city","ip","postal","region"].forEach(function(i){if(t.settings.targeting.location[i]&&t.settings.targeting.location[i].constructor===Array&&!t.settings.targeting.location[i].includes(e[i]))return n()}),i()}):i()})}},{key:"showBar",value:function(){var t=this;document.querySelector("#".concat(this.id))&&(this.bar.style.transition=(this.settings.duration||500)+"ms",setTimeout(function(){t.bar.classList.add("hello-bar--is-visible")},this.settings.delay||1),this.$emit("show-bar",this.bar))}},{key:"unMove",value:function(){for(var t=document.querySelectorAll(".hello-bar--has-moved"),e=0;e<t.length;e++){var n=parseInt(t[e].style[this.marginProp]);t[e].style[this.marginProp]="".concat(n-this.height,"px"),t[e].classList.remove("hello-bar--has-moved")}}},{key:"hideBar",value:function(){var t=this;document.querySelector("#".concat(this.id))&&(this.bar.classList.remove("hello-bar--is-visible"),sessionStorage.setItem("hello-bar--session-showed",!0),localStorage.setItem("hello-bar--user-showed",!0),this.unMove(),setTimeout(function(){t.bar.parentNode.removeChild(t.bar)},(this.settings.duration||500)+1),this.$emit("hide-bar",this.bar))}},{key:"functionBar",value:function(){var t=this;document.querySelector(".hello-bar button.hello-bar-button")&&document.querySelector(".hello-bar button.hello-bar-button").addEventListener("click",function(){t.$emit("close-bar",t.bar),t.hideBar()});var e={mouseenter:"mouse-enter",mouseleave:"mouse-leave",click:"mouse-click",mouseup:"mouse-up",mousedown:"mouse-down"},n=document.querySelector(".hello-bar .cta");Object.keys(e).forEach(function(i){t.bar.addEventListener(i,function(){return t.$emit(e[i],t.bar)}),n&&n.addEventListener(i,function(){return t.$emit("cta-".concat(e[i]),n)})})}},{key:"colorizeBar",value:function(){if(document.querySelector("#".concat(this.id))){var t=this.settings.background||"#eeeeee",e=this.settings.textColor||r()(t);this.bar.style.backgroundColor=t,document.querySelector(".hello-bar .hello-bar-text--after")&&(document.querySelector(".hello-bar .hello-bar-text--after").style.background="linear-gradient(to right, rgba(0, 0, 0, 0), ".concat(t,")")),this.bar.style.color=e,this.bar.style.textAlign=this.settings.align||"center",document.querySelector(".hello-bar p.hello-bar-text .cta")&&(document.querySelector(".hello-bar p.hello-bar-text .cta").style.color=this.settings.background||"#eeeeee",document.querySelector(".hello-bar p.hello-bar-text .cta").style.background=e,this.$emit("color-bar",{backgroundColor:t,textColor:e}))}}},{key:"calculateHeight",value:function(){document.querySelector("#".concat(this.id))&&(this.settings.size&&this.bar.classList.add("hello-bar--size-".concat(this.settings.size)),"function"===typeof this.bar.getBoundingClientRect&&this.bar.getBoundingClientRect().height?this.height=this.bar.getBoundingClientRect().height:this.height=this.bar.offsetHeight,this.height=parseInt(this.height),this.$emit("calculate-height",this.height))}},{key:"insertBar",value:function(){var t=document.querySelector("body > *");t?document.body.insertBefore(this.bar,t):document.body.appendChild(this.bar),this.$emit("created",this.bar)}},{key:"moveElements",value:function(t){if(t)if("string"===typeof t)for(var e=document.querySelectorAll(t),n=0;n<e.length;n++)this.moveElements(e[n]);else if(t.constructor===Array&&t.length)for(var i=0;i<t.length;i++)this.moveElements(t[i]);else if("object"===_typeof(t)&&"object"===_typeof(t.classList)&&"function"===typeof t.classList.add&&!t.classList.contains("hello-bar--has-moved")){var r=t.currentStyle||window.getComputedStyle(t);"object"===_typeof(r)&&r[this.marginProp]?t.style[this.marginProp]="".concat(parseInt(r[this.marginProp])+this.height,"px"):t.style[this.marginProp]="".concat(this.height,"px"),this.$emit("move-element",t),t.classList.add("hello-bar--has-moved")}}},{key:"getIpInfo",value:function(){var t=this;return this.$emit("start-ip-info"),new Promise(function(e,n){var i,r;(i=t.settings.ipEndpoint||"https://ipinfo.io/json",new Promise(function(t,e){var n="hello_bar_cache_".concat(i).concat(r?"_"+JSON.stringify(r):"");if(localStorage.getItem(n))try{var o=JSON.parse(localStorage.getItem(n));if(o.expires_at>(new Date).getTime())return t(o.cache_value)}catch(s){}fetch(i,r).then(function(t){return t.json()}).then(function(e){localStorage.setItem(n,JSON.stringify({created_at:(new Date).getTime(),expires_at:(new Date).getTime()+6048e5,cache_value:e})),t(e)}).catch(function(t){return e(t)})})).then(function(n){t.$emit("fetch-ip-info",n),e(n)}).catch(function(e){t.$emit("error-ip-info",e),n(e)})})}}])&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),App}();e.default=c}])});
//# sourceMappingURL=index.js.map